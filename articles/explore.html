<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Explore • chemunits</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Explore">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chemunits</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/explore.html">Explore</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kopflab/chemunits/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Explore</h1>
            
            <h4 data-toc-skip class="date">2025-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kopflab/chemunits/blob/main/vignettes/explore.Rmd" class="external-link"><code>vignettes/explore.Rmd</code></a></small>
      <div class="d-none name"><code>explore.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kopflab/chemunits" class="external-link">chemunits</a></span><span class="op">)</span> <span class="co"># load the library</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-are-chemunits">What are chemunits?<a class="anchor" aria-label="anchor" href="#what-are-chemunits"></a>
</h2>
<p>FIXME: point to [units::set_units()] documentation and
[units::valid_udunits()]</p>
<div class="section level3">
<h3 id="conversions">Conversions<a class="anchor" aria-label="anchor" href="#conversions"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># standard conversions</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"N"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"kN"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 0.001 [kN]</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"V*A*s"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"N*cm"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 100 [cm*N]</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># more complex (and fun but not always useful) </span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"horsepower"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"W"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 745.6999 [W]</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"dram"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"g"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1.771845 [g]</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"firkin"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"L"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 39.74683 [L]</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"fortnight"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"days"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 14 [d]</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"fathom"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"pica"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 433.6209 [pica]</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># more complex and useful for chemistry</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"degC"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"degF"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 32 [degF]</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">32</span>, <span class="st">"degF"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"K"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 273.15 [K]</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"bar"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"atm"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 0.9869233 [atm]</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"bar"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"psi"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 14.50377 [psi]</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mbar"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"mTorr"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 750.0616 [mTorr]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="preferred-units">Preferred units<a class="anchor" aria-label="anchor" href="#preferred-units"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>preferred_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lb"</span>, convert_to_preferred <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 453.5924 [g]</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">15</span>, <span class="st">"psi"</span>, convert_to_preferred <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># no preferred unit defined for pressure</span></span></code></pre></div>
<pre><code><span><span class="co">## 15 [psi]</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>preferred_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"bar"</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">15</span>, <span class="st">"psi"</span>, convert_to_preferred <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># FIXME: why does this not work?</span></span></code></pre></div>
<pre><code><span><span class="co">## 15 [psi]</span></span></code></pre>
<p>Preferred units are particularly convenient when converting units
through multiplication and division of different units as described in
more details in the <a href="#arithmetic">Arithmetic section</a>.</p>
</div>
<div class="section level3">
<h3 id="auto-scaling">Auto-scaling<a class="anchor" aria-label="anchor" href="#auto-scaling"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="fixme">FIXME<a class="anchor" aria-label="anchor" href="#fixme"></a>
</h2>
<p>All chemical quantities in this package keep track of the units they
represent with a base unit as detailed in the <a href="quantities.html">quantities vignette</a> and a metric prefix. By
default, the metric prefix is adjusted automatically to keep numeric
values in a range close to 1. However, scaling to a specific prefix is
easily achieved.</p>
<p>and point to [units::valid_udunits_prefixes()]</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># automatic scaling</span></span>
<span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>auto_scale_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"L"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"g"</span><span class="op">)</span> <span class="co"># automatically scaled to kg</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 [kg]</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"nL"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1e5</span> <span class="co"># automatically scaled to mL</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 [mL]</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1e-4</span>, <span class="st">"M"</span><span class="op">)</span> <span class="co"># automatically scaled to microM</span></span></code></pre></div>
<pre><code><span><span class="co">## 100 [µM]</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># no automatic scaling</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"g"</span>, auto_scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># explicly stays g</span></span></code></pre></div>
<pre><code><span><span class="co">## 500 [mg]</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"J"</span><span class="op">)</span> <span class="co"># stays J because it wasn't defined to be included</span></span></code></pre></div>
<pre><code><span><span class="co">## 5000 [J]</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># enable it for J too</span></span>
<span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>auto_scale_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"L"</span>, <span class="st">"M"</span>, <span class="st">"J"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"J"</span><span class="op">)</span> <span class="co"># now it becomes kJ</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 [kJ]</span></span></code></pre>
<div class="section level3">
<h3 id="formatting">Formatting<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h3>
<p>To retrieve numeric values as text that includes their units, simply
use <code>[base::format()]</code>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get quantity with unit</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "100 [mg]"</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="st">"C"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] " 0 [C]" " 1 [C]" " 2 [C]" " 3 [C]" " 4 [C]" " 5 [C]" " 6 [C]" " 7 [C]"</span></span>
<span><span class="co">##  [9] " 8 [C]" " 9 [C]" "10 [C]"</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">760</span>, <span class="st">"Torr"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "760 [Torr]"</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># by default autosales each value individually if the unit is scalalbe</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># auto-scalable unit</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "100 [mg]" "1 [g]"    "1 [kg]"</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="st">"N"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "1e-01 [N]" "1e+00 [N]" "1e+03 [N]"</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># but the autoscaling can be turned off too</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span>auto_scale <span class="op">=</span> <span class="cn">FALSE</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "   0.1 [g]" "   1.0 [g]" "1000.0 [g]"</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or you can specify the desired unit</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span>units <span class="op">=</span> <span class="st">"kg"</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "0.0001 [kg]" "0.0010 [kg]" "1.0000 [kg]"</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># of course impossible conversion don't work</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"kg"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span>units <span class="op">=</span> <span class="st">"J"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in `units&lt;-`(`*tmp*`, value = units) : </span></span>
<span><span class="co">##   cannot convert kg into J</span></span></code></pre>
<p>The numeric value of a quantity can be retrieved via the
<code>get_chemvalue()/get_cv()</code> function which converts to the
requested units (if possible) and returns the numeric value in those
units.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># FIXME: move this to the end</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_chemvalue.html">get_cv</a></span><span class="op">(</span><span class="st">"mg"</span><span class="op">)</span> <span class="co"># returns 100</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 100</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"kg"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_chemvalue.html">get_cv</a></span><span class="op">(</span><span class="st">"lb"</span><span class="op">)</span> <span class="co"># can use any valid unit</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.204623</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"degC"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_chemvalue.html">get_cv</a></span><span class="op">(</span><span class="st">"degF"</span><span class="op">)</span> <span class="co"># or use it for unit conversion</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 32</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">760</span>, <span class="st">"Torr"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_chemvalue.html">get_cv</a></span><span class="op">(</span><span class="st">"atm"</span><span class="op">)</span> <span class="co"># or use it for unit conversion</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"kg"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_chemvalue.html">get_cv</a></span><span class="op">(</span><span class="st">"M"</span><span class="op">)</span><span class="op">)</span> <span class="co"># impossible conversions fail</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in `units&lt;-`(`*tmp*`, value = units) : </span></span>
<span><span class="co">##   cannot convert kg into M</span></span></code></pre>
<p>The units of a number can also be retrieved directly with the
<code><a href="../reference/get_units.html">get_units()</a></code> function for vectors, lists, as well as entire
data frames (see details on the latter in the <a href="#data-frames">data frames section</a>).</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_units.html">get_units</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "kg"</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"g"</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  c <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"mbar"</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_units.html">get_units</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      a      b      c </span></span>
<span><span class="co">##   "kg"     NA "mbar"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="arithmetic">Arithmetic<a class="anchor" aria-label="anchor" href="#arithmetic"></a>
</h2>
<p>Several common arithmetic operations are implemented for easy
inter-conversion between quantities. All arithmetic operations also
automatically keep track of the units and metric prefixes for correct
calculations.</p>
<div class="section level3">
<h3 id="addition-and-subtraction">Addition and Subtraction<a class="anchor" aria-label="anchor" href="#addition-and-subtraction"></a>
</h3>
<p>Quantities of the same type (e.g. masses, volumes, etc.) can be added
or subtracted with proper interpration of the metric prefixes. The
resulting quantity will be scaled to the best metric prefix as described
above. Attempts to add or subtract non-matching quantities (e.g. mass +
volume) or a quantity and a number without units will fail with an error
to avoid unexpect behaviour and ambiguous calculations.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">0.003</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"µg"</span><span class="op">)</span> <span class="co"># 1.005 mg</span></span></code></pre></div>
<pre><code><span><span class="co">## 1.005 [mg]</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"L"</span><span class="op">)</span><span class="op">)</span> <span class="co"># not allowed</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in `units&lt;-`(`*tmp*`, value = units(e1)) : </span></span>
<span><span class="co">##   cannot convert L into g</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># not allowed</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in Ops.units(set_cu(1, "g"), 1) : </span></span>
<span><span class="co">##   both operands of the expression should be "units" objects</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="multiplication-division">Multiplication / Division<a class="anchor" aria-label="anchor" href="#multiplication-division"></a>
</h3>
<p>Quantities can be multipled/divided by a number. The resulting
quantity will be scaled to the best metric prefix. This is most commonly
used with multiplication/division by 1000.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span> <span class="co"># convert mg into g</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 [g]</span></span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span> <span class="co"># convert mg into ng</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 [ng]</span></span></code></pre>
<p>Quantities can also be divided by another quantity of the same type
(e.g. a mass by another mass) effectively canceling out the units
resulting in a unitless ratio (symbolized by <code>[1]</code>) with the
metric prefixes properly taken into consideration.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># how many mg in a kg?</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"kg"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mg"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1e+06 [1]</span></span></code></pre>
<p>Thanks to the underlying <strong><a href="https://r-quantities.github.io/units/" class="external-link">units</a></strong> package
and <a href="https://github.com/Unidata/UDUNITS-2" class="external-link">UDUNITS-2</a> API,
almost any unit calculations are possible. In cases where the result can
be converted to one of your preferred units, that conversion and proper
prefix scaling also happens automatically. A few examples below</p>
<div class="section level4">
<h4 id="concentration-molarity-amount-volume">Concentration (Molarity) = Amount / Volume<a class="anchor" aria-label="anchor" href="#concentration-molarity-amount-volume"></a>
</h4>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate molarity --&gt; uh oh, no automatic converstion to M</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"nmol"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mL"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## 0.1 [nmol/mL]</span></span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set preferred units</span></span>
<span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>preferred_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mol"</span>, <span class="st">"g"</span>, <span class="st">"g/mol"</span>, <span class="st">"M/bar"</span>, <span class="st">"M"</span>, <span class="st">"L"</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"nmol"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mL"</span><span class="op">)</span> <span class="co"># calculation molarity</span></span></code></pre></div>
<pre><code><span><span class="co">## 100 [nM]</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"nmol"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"nM"</span><span class="op">)</span> <span class="co"># calculate volume</span></span></code></pre></div>
<pre><code><span><span class="co">## 50 [mL]</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"nM"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mL"</span><span class="op">)</span> <span class="co"># calculate amount</span></span></code></pre></div>
<pre><code><span><span class="co">## 5e-09 [mol]</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="concentration-density-mass-volume">Concentration (Density) = Mass / Volume<a class="anchor" aria-label="anchor" href="#concentration-density-mass-volume"></a>
</h4>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"ng"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mL"</span><span class="op">)</span> <span class="co"># calculate density</span></span></code></pre></div>
<pre><code><span><span class="co">## 100 [pg/mL]</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"ng"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"ng/L"</span><span class="op">)</span> <span class="co"># calculate volume</span></span></code></pre></div>
<pre><code><span><span class="co">## 50 [mL]</span></span></code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"ng/L"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mL"</span><span class="op">)</span> <span class="co"># calculate mass</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 [ng]</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="amount-mass-molecular-mass">Amount = Mass / Molecular Mass<a class="anchor" aria-label="anchor" href="#amount-mass-molecular-mass"></a>
</h4>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"g/mol"</span><span class="op">)</span> <span class="co"># calculate amount</span></span></code></pre></div>
<pre><code><span><span class="co">## 0.2 [mol]</span></span></code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">200</span>, <span class="st">"mmol"</span><span class="op">)</span> <span class="co"># calculate molecular weight</span></span></code></pre></div>
<pre><code><span><span class="co">## 50 [g/mol]</span></span></code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">200</span>, <span class="st">"mmol"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"g/mol"</span><span class="op">)</span> <span class="co"># calculate mass</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 [g]</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="solubility-molarity-pressure">Solubility = Molarity / Pressure<a class="anchor" aria-label="anchor" href="#solubility-molarity-pressure"></a>
</h4>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"mM"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">200</span>, <span class="st">"mbar"</span><span class="op">)</span> <span class="co"># calculate solubility</span></span></code></pre></div>
<pre><code><span><span class="co">## 50 [mM/bar]</span></span></code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"mM"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mM/bar"</span><span class="op">)</span> <span class="co"># calculate pressure</span></span></code></pre></div>
<pre><code><span><span class="co">## 0.2 [bar]</span></span></code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"mM/bar"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">200</span>, <span class="st">"mbar"</span><span class="op">)</span> <span class="co"># calculate molarity</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 [mM]</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="comparisons">Comparisons<a class="anchor" aria-label="anchor" href="#comparisons"></a>
</h3>
<p>Quantities can be compared with all common logic operators
(<code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>,
<code>&lt;=</code>, <code>==</code>, <code>!=</code>) taking the metric
scaling properly into consideration. Attempts to compare non-matching
quantities (e.g. mass &amp; volume) will fail with an error to avoid
unexpect behaviour. Comparisons of quantities with numerics are allowed
but it is important to be cautious about these since the metric scaling
in quantities affects the numeric value.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"g"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"ng"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="st">"g"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"g"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mg"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"L"</span><span class="op">)</span><span class="op">)</span> <span class="co"># not allowed (different quantities)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in Ops.units(set_cu(1, "mg"), set_cu(1, "L")) : </span></span>
<span><span class="co">##   cannot compare non-convertible units</span></span></code></pre>
<p>It is important to note that due to machine errors, the
<code>==</code> is best avoided in favor of more reliable comparisons
such as tests that check whether the difference between quantities is
smaller than a tiny quantity:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whether it's *3 and then /3 or the other way around should be identical</span></span>
<span><span class="co"># but is not because of machine precision</span></span>
<span><span class="va">x</span><span class="op">*</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span> <span class="op">==</span> <span class="va">x</span><span class="op">/</span><span class="fl">3</span><span class="op">*</span><span class="fl">3</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/near.html" class="external-link">near</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span>, <span class="va">x</span><span class="op">/</span><span class="fl">3</span><span class="op">*</span><span class="fl">3</span>, tol <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"fg"</span><span class="op">)</span><span class="op">)</span> <span class="co"># the same within 1 femtogram</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="data-frames">Data Frames<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h2>
<p>Units (and thus chemunits as well) are fully supported in dplyr type
data frames (tibbles) and the units are displayed underneath the column
headers, e.g. <code>[mL]</code>:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"mg"</span><span class="op">)</span>,</span>
<span>  volume <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">20</span>, <span class="st">"mL"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">##   weight volume</span></span>
<span><span class="co">##     <span style="color: #949494;">[mg]</span>   <span style="color: #949494;">[mL]</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1     20</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      2     20</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      3     20</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>      4     20</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>      5     20</span></span></code></pre>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or for formatted output in notebooks</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">weight</th>
<th align="right">volume</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1 [mg]</td>
<td align="right">20 [mL]</td>
</tr>
<tr class="even">
<td align="right">2 [mg]</td>
<td align="right">20 [mL]</td>
</tr>
<tr class="odd">
<td align="right">3 [mg]</td>
<td align="right">20 [mL]</td>
</tr>
<tr class="even">
<td align="right">4 [mg]</td>
<td align="right">20 [mL]</td>
</tr>
<tr class="odd">
<td align="right">5 [mg]</td>
<td align="right">20 [mL]</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or with explicit units in the header</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/make_units_explicit.html">make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">weight [mg]</th>
<th align="right">volume [mL]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>This also means that all arithmetic operations are allowed within
data frames.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"mg"</span><span class="op">)</span>,</span>
<span>  vol <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">20</span>, <span class="st">"mL"</span><span class="op">)</span>,</span>
<span>  mw <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">500</span>, <span class="st">"g/mol"</span><span class="op">)</span>,</span>
<span>  amount <span class="op">=</span> <span class="va">weight</span> <span class="op">/</span> <span class="va">mw</span>,</span>
<span>  conc <span class="op">=</span> <span class="va">amount</span> <span class="op">/</span> <span class="va">vol</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">##      id weight  vol      mw   amount conc</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494;">[mg]</span> <span style="color: #949494;">[mL]</span> <span style="color: #949494;">[g/mol]</span>    <span style="color: #949494;">[mol]</span> <span style="color: #949494;">[µM]</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1      1   20     500 0.000<span style="text-decoration: underline;">002</span>  100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2      2   20     500 0.000<span style="text-decoration: underline;">004</span>  200</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3      3   20     500 0.000<span style="text-decoration: underline;">006</span>  300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4      4   20     500 0.000<span style="text-decoration: underline;">008</span>  400</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5      5   20     500 0.000<span style="text-decoration: underline;">01</span>   500</span></span></code></pre>
<p>To get the columns’ units use <code><a href="../reference/get_units.html">get_units()</a></code></p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_units.html">get_units</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      id  weight     vol      mw  amount    conc </span></span>
<span><span class="co">##      NA    "mg"    "mL" "g/mol"   "mol"    "µM"</span></span></code></pre>
<p>To make units of specific columns explicit, use
<code><a href="../reference/make_units_explicit.html">make_units_explicit()</a></code></p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make all units columns explicit</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/make_units_explicit.html">make_units_explicit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">##      id `weight [mg]` `vol [mL]` `mw [g/mol]` `amount [mol]` `conc [µM]`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1             1         20          500       0.000<span style="text-decoration: underline;">002</span>         100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2             2         20          500       0.000<span style="text-decoration: underline;">004</span>         200</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3             3         20          500       0.000<span style="text-decoration: underline;">006</span>         300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4             4         20          500       0.000<span style="text-decoration: underline;">008</span>         400</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5             5         20          500       0.000<span style="text-decoration: underline;">01</span>          500</span></span></code></pre>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change the prefix and suffix</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/make_units_explicit.html">make_units_explicit</a></span><span class="op">(</span>prefix <span class="op">=</span> <span class="st">"."</span>, suffix <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">##      id weight.mg vol.mL `mw.g/mol` amount.mol conc.µM</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1         1     20        500   0.000<span style="text-decoration: underline;">002</span>     100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2         2     20        500   0.000<span style="text-decoration: underline;">004</span>     200</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3         3     20        500   0.000<span style="text-decoration: underline;">006</span>     300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4         4     20        500   0.000<span style="text-decoration: underline;">008</span>     400</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5         5     20        500   0.000<span style="text-decoration: underline;">01</span>      500</span></span></code></pre>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make a specific subset of columns explicit (using tidy select syntax)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/make_units_explicit.html">make_units_explicit</a></span><span class="op">(</span><span class="va">weight</span><span class="op">:</span><span class="va">mw</span><span class="op">)</span> <span class="co"># from weight to mw</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">##      id `weight [mg]` `vol [mL]` `mw [g/mol]`   amount conc</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494;">[mol]</span> <span style="color: #949494;">[µM]</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1             1         20          500 0.000<span style="text-decoration: underline;">002</span>  100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2             2         20          500 0.000<span style="text-decoration: underline;">004</span>  200</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3             3         20          500 0.000<span style="text-decoration: underline;">006</span>  300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4             4         20          500 0.000<span style="text-decoration: underline;">008</span>  400</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5             5         20          500 0.000<span style="text-decoration: underline;">01</span>   500</span></span></code></pre>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/make_units_explicit.html">make_units_explicit</a></span><span class="op">(</span><span class="op">-</span><span class="va">mw</span><span class="op">)</span> <span class="co"># all but mw</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">##      id `weight [mg]` `vol [mL]`      mw `amount [mol]` `conc [µM]`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494;">[g/mol]</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1             1         20     500       0.000<span style="text-decoration: underline;">002</span>         100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2             2         20     500       0.000<span style="text-decoration: underline;">004</span>         200</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3             3         20     500       0.000<span style="text-decoration: underline;">006</span>         300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4             4         20     500       0.000<span style="text-decoration: underline;">008</span>         400</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5             5         20     500       0.000<span style="text-decoration: underline;">01</span>          500</span></span></code></pre>
<p>To just straight-up remove the units from a tibble, use
<code><a href="https://r-quantities.github.io/units/reference/drop_units.html" class="external-link">drop_units()</a></code>:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/drop_units.html" class="external-link">drop_units</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">##      id weight   vol    mw   amount  conc</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1      1    20   500 0.000<span style="text-decoration: underline;">002</span>   100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2      2    20   500 0.000<span style="text-decoration: underline;">004</span>   200</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3      3    20   500 0.000<span style="text-decoration: underline;">006</span>   300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4      4    20   500 0.000<span style="text-decoration: underline;">008</span>   400</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     5      5    20   500 0.000<span style="text-decoration: underline;">01</span>    500</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>Quantities are automatically plotted with proper axis labels if used
in <code>ggplot</code>.</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example data set</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>    conc <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">25</span><span class="op">)</span>, <span class="st">"mM"</span><span class="op">)</span>,</span>
<span>    volume <span class="op">=</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">90</span>, <span class="fl">400</span><span class="op">)</span>, <span class="st">"mL"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    amount <span class="op">=</span> <span class="va">conc</span> <span class="op">*</span> <span class="va">volume</span>,</span>
<span>    amount_text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">amount</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   conc volume    amount amount_text   </span></span>
<span><span class="co">##   <span style="color: #949494;">[mM]</span>   <span style="color: #949494;">[mL]</span>     <span style="color: #949494;">[mol]</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  0.5    0.2 0.000<span style="text-decoration: underline;">000</span>1 1.00e-07 [mol]</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  0.5   90   0.000<span style="text-decoration: underline;">045</span>  4.50e-05 [mol]</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  0.5  400   0.000<span style="text-decoration: underline;">2</span>    2.00e-04 [mol]</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 25      0.2 0.000<span style="text-decoration: underline;">005</span>  5.00e-06 [mol]</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 25     90   0.002<span style="text-decoration: underline;">25</span>   2.25e-03 [mol]</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 25    400   0.01      1.00e-02 [mol]</span></span></code></pre>
<p>By default, units are included in the x and y axes titles if a
quantity is being plotted. Discrete quantities used for other aesthetics
can be converted to a factor using [forcats::fct_in_order()] which
automatically includes the units and keeps the levels in order of
appearance (using [factor()] rearranges them alphabetically).</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>conc <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">volume</span>, y <span class="op">=</span> <span class="va">amount</span>, color <span class="op">=</span> <span class="va">conc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">conc</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: The `scale_name` argument of `continuous_scale()` is deprecated as of ggplot2</span></span>
<span><span class="co">## 3.5.0.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="explore_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<p>Alternatively, the units can be specified for the axes using the
[units::scale_x_units()] and [units::scale_y_units()] functions and the
<code>units</code> parameter to the <code><a href="https://rdrr.io/r/base/format.html" class="external-link">format()</a></code> function.
Units must be valid for the quantities that are plotted.</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>conc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">conc</span>, units <span class="op">=</span> <span class="st">"mM"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">volume</span>, y <span class="op">=</span> <span class="va">amount</span>, color <span class="op">=</span> <span class="va">conc</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">conc</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-quantities.github.io/units/reference/scale_units.html" class="external-link">scale_x_units</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-quantities.github.io/units/reference/scale_units.html" class="external-link">scale_y_units</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">"mmol"</span><span class="op">)</span></span></code></pre></div>
<p><img src="explore_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="fixme-1">FIXME<a class="anchor" aria-label="anchor" href="#fixme-1"></a>
</h2>
<p>–&gt; this does not work yet, have to implement scale_x_chemunits it
seems :(</p>
<p>Lastly, the <code>scale_x_set_cu()</code> and
<code>scale_y_set_cu()</code> support all axis transformations supported
by <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous()</a></code> and
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous()</a></code>. For example the <code>log10</code>
transform can be used like this:</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># df |&gt;</span></span>
<span><span class="co">#   mutate(conc = fct_inorder(format(conc))) |&gt; </span></span>
<span><span class="co">#   ggplot() +</span></span>
<span><span class="co">#   aes(x = volume, y = amount, color = conc) +</span></span>
<span><span class="co">#   geom_line() +</span></span>
<span><span class="co">#   facet_wrap(~conc, scales = "free") +</span></span>
<span><span class="co">#   scale_x_units(transform = "log10", auto_scale = TRUE) +</span></span>
<span><span class="co">#   scale_y_units(transform = "log10", auto_scale = TRUE)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="concatenation">Concatenation<a class="anchor" aria-label="anchor" href="#concatenation"></a>
</h2>
<p>Numbers with units can be concatenated using the regular
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function as long as they are compatible. Concatenation
make sure that the metric prefix is taken into consideration and scales
the new vector to the best metric of the median.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"g"</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"mg"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"g"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ChemUnits: [mg]</span></span>
<span><span class="co">## [1] 1000    1    2    3 2000</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>Missing data (<code>NA</code>), empty vector
(<code>numeric(0)</code>) and infinity placeholders (<code>Inf</code>,
<code>-Inf</code>) are fully supported and work the same as in any other
R vectors.</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="cn">NA</span>, <span class="op">-</span><span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>, <span class="st">"mg"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ChemUnits: [mg]</span></span>
<span><span class="co">## [1]   10   NA -Inf  Inf</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="defining-new-units">Defining new units<a class="anchor" aria-label="anchor" href="#defining-new-units"></a>
</h2>
<p>You can add your own units thanks to [units::install_unit()] and then
include it in your <code>preferred_units</code> and/or
<code>auto_scale_units</code> to make full use of the chemunits
functionality. For example, let’s define the SI-accepted unit
<em>Dalton</em> as an alternative for molecular weight (sometimes also
called molar mass or molecular mass) with <em>1 Da = 1 g/mol</em>:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define new unit</span></span>
<span><span class="fu"><a href="https://r-quantities.github.io/units/reference/install_unit.html" class="external-link">install_unit</a></span><span class="op">(</span><span class="st">"Da"</span>, <span class="st">"g/mol"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># test conversion</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"g/mol"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="st">"Da"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 [Da]</span></span></code></pre>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># include in preferred and auto-scale units</span></span>
<span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>preferred_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mol"</span>, <span class="st">"g"</span>, <span class="st">"Da"</span>, <span class="st">"M/bar"</span>, <span class="st">"M"</span>, <span class="st">"L"</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chemunits_options.html">chemunits_options</a></span><span class="op">(</span>auto_scale_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mol"</span>, <span class="st">"g"</span>, <span class="st">"Da"</span>, <span class="st">"M/bar"</span>, <span class="st">"M"</span>, <span class="st">"L"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="st">"g"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/set_chemunits.html">set_cu</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mol"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 [kDa]</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
